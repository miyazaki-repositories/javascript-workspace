# ブラウザのタブ複製機能で同じドメインのセッションストレージ値を共有したくない

## 前置き

- セッションストレージは同じドメインでも以下のケースで共有・引き継ぎされません
  - 新しいタブで開く
  - 新しいブラウザで開く

- 下記のケースでは引き注がれます
  - ブラウザ機能でタブを複製する
    - ややこしいことに、ブラウザによってタブ複製しても引き継がれません！safari！
    - 共有ではないことに注意してください。複製後のタブBでセッションストレージを変更したとき、複製元のタブAには反映されません。

## 検証したいこと

- ブラウザのタブ複製を行ったとき、
  - 複製先タブの初期表示でjavascriptで複製イベントは発生したことを検知できるか？
  - 複製イベントを検知したタイミングで任意の処理を実行できるか？

## 検証

```shell
# ディレクトリ移動とnginxコンテナ起動
cd ./vanillajs/brower_tab_clone_same_domain_session_storage
docker-compose up -d
```

- ブラウザで `http://localhost:8080/` を開く
- 画面からセッションストレージに値を設定して、タブの複製など操作する
- 複製元のタブ、複製先のタブでセッションストレージの値がどうなるか確認する

## 結論

- javascriptのBroadCast APIを使用して検知・任意の処理を実行できるが、タブの複製だけ検知することはできない
  - 同じページを新しいタブ・ウィンドウで開いた場合も検知してしまい、制御がややこしい。。。
  - 複製後に元のタブでリロードを行うとセッションストレージが空になってしまう
